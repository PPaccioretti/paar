<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="paar">
<title>Zone delineation • paar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Zone delineation">
<meta property="og:description" content="paar">
<meta property="og:image" content="https://ppaccioretti.github.io/paar/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">paar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Yield_data.html">Yield data preprocessing</a>
    <a class="dropdown-item" href="../articles/Zone_delineation.html">Zone delineation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/PPaccioretti/paar/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Zone delineation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/PPaccioretti/paar/blob/HEAD/vignettes/Zone_delineation.Rmd" class="external-link"><code>vignettes/Zone_delineation.Rmd</code></a></small>
      <div class="d-none name"><code>Zone_delineation.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ppaccioretti.github.io/paar/">paar</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span></code></pre></div>
<p>Multivariate zone delineation can be done using <code>kmspc</code>
function, whereas univariate zone delineation can be done with
<code>fyzzy_k_means</code> function.</p>
<p>Multivariate function implements the protocol proposed by <span class="citation">Córdoba et al. (2016)</span>, which performs a
clustering with the <code>kmeans</code> function using as an input the
spatial principal components (sPC) of the data. The function requires an
<code>sf</code> object with the data to be clustered, and more than one
numeric variable. The function by default returns a list with the
following components: - <code>summaryResults</code>: a
<code>data.frame</code> with - <code>indices</code>: a
<code>data.frame</code> with indices to help to chose the optimal number
of clusters. - <code>cluster</code>: the cluster number assigned to each
observation.</p>
<p>For this example we will use the <code>wheat</code> dataset that
comes with the <code>paar</code> package. The <code>data.frame</code>
has apparent electrical conductivity (ECa) meassured at two depths,
elevation data, soil depth, and wheat gran yield. All variables have
been interpolated to an unique grid and then merged in a single
<code>data.frame</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wheat</span>, package <span class="op">=</span> <span class="st">'paar'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wheat_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">wheat</span>,</span>
<span>                     coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x'</span>, <span class="st">'y'</span><span class="op">)</span>,</span>
<span>                     crs <span class="op">=</span> <span class="fl">32720</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wheat_sf</span><span class="op">)</span></span></code></pre></div>
<p><img src="Zone_delineation_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>The function <code>kmspc</code> requires the <code>sf</code> object
with the data to be clustered, and the number of clusters (zones) to be
delineated. For the sPC process, is necessary to specify the distance in
wshich observations will be considered neighbors. The <code>ldist</code>
and <code>udist</code> arguments specify the lower and upper distance
thresholds, respectively. The <code>explainedVariance</code> argument
specifies the minimum value of explained variance that the Principal
Component to be used for the cluster process should explain. The
<code>center</code> argument specifies if the data should be centered
before the sPC process (default <code>TRUE</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run the kmspc function</span></span>
<span><span class="va">kmspc_results</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/kmspc.html">kmspc</a></span><span class="op">(</span><span class="va">wheat_sf</span>,</span>
<span>        number_cluster <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>,</span>
<span>        explainedVariance <span class="op">=</span> <span class="fl">70</span>,</span>
<span>        ldist <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        udist <span class="op">=</span> <span class="fl">40</span>,</span>
<span>        center <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: All numeric Variables will be used to make clusters</span></span></code></pre></div>
<p>To help the user to chose the optimal number of clusters, the
function returns a <code>data.frame</code> with indices
(<code>Xie Beni</code>, <code>Partition Coefficient</code>,
<code>Entropy of Partition</code>, and <code>Summary Index</code>). The
<code>Summary Index</code> is a combination of the indices to obtain a
measure of the information reported by each index. In this example, the
optimuin number of cluster is 2. For each index, lower the value better
the clustering. More information can be found in <span class="citation">Paccioretti, Córdoba, and Balzarini (2020)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kmspc_results</span><span class="op">$</span><span class="va">indices</span></span>
<span><span class="co">#&gt;   Num. Cluster     Xie Beni Partition Coefficient Entropy of Partition</span></span>
<span><span class="co">#&gt; 1            2 3.521080e-05             0.9611962           0.06490329</span></span>
<span><span class="co">#&gt; 2            3 5.479198e-05             0.9391147           0.10430166</span></span>
<span><span class="co">#&gt; 3            4 5.826635e-05             0.9293043           0.12351022</span></span>
<span><span class="co">#&gt;   Summary Index</span></span>
<span><span class="co">#&gt; 1      1.281143</span></span>
<span><span class="co">#&gt; 2      1.597505</span></span>
<span><span class="co">#&gt; 3      1.713109</span></span></code></pre></div>
<p>The cluster for each observation can be found in the
<code>cluster</code> component of the <code>kmspc</code> object. The
<code>cluster</code> component is a <code>data.frame</code> with the
cluster number assigned to each observation.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">kmspc_results</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Cluster_2 Cluster_3 Cluster_4</span></span>
<span><span class="co">#&gt; [1,] "1"       "2"       "4"      </span></span>
<span><span class="co">#&gt; [2,] "1"       "2"       "4"      </span></span>
<span><span class="co">#&gt; [3,] "1"       "2"       "4"      </span></span>
<span><span class="co">#&gt; [4,] "1"       "1"       "4"      </span></span>
<span><span class="co">#&gt; [5,] "1"       "1"       "4"      </span></span>
<span><span class="co">#&gt; [6,] "1"       "1"       "4"</span></span></code></pre></div>
<p>The clusters can be combined to the original data using the
<code>cbind</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wheat_clustered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">wheat_sf</span>, <span class="va">kmspc_results</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span></code></pre></div>
<p>This cluster can be plotted with the <code>plot</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wheat_clustered</span><span class="op">[</span>, <span class="st">"Cluster_2"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="Zone_delineation_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Also, ggplot can be used to plot the clusters.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">wheat_clustered</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Cluster_2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Zone_delineation_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Cordoba2016" class="csl-entry">
Córdoba, Mariano, Cecilia Bruno, José Luis Costa, Nahuel Peralta, and
Mónica Balzarini. 2016. <span>“Protocol for Multivariate Homogeneous
Zone Delineation in Precision Agriculture.”</span> <em>Biosystems
Engineering</em> 143 (March): 95–107. <a href="https://doi.org/10.1016/j.biosystemseng.2015.12.008" class="external-link">https://doi.org/10.1016/j.biosystemseng.2015.12.008</a>.
</div>
<div id="ref-Paccioretti2020" class="csl-entry">
Paccioretti, P., M. Córdoba, and M. Balzarini. 2020. <span>“FastMapping:
Software to Create Field Maps and Identify Management Zones in Precision
Agriculture.”</span> <em>Computers and Electronics in Agriculture</em>
175 (August). <a href="https://doi.org/10.1016/j.compag.2020.105556" class="external-link">https://doi.org/10.1016/j.compag.2020.105556</a>.
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pablo Paccioretti, Mariano Córdoba, Franca Giannini Kurina.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
