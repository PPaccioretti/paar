<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="paar">
<title>Yield data preprocessing • paar</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Yield data preprocessing">
<meta property="og:description" content="paar">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">paar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Yield_data.html">Yield data preprocessing</a>
    <a class="dropdown-item" href="../articles/Zone_delineation.html">Zone delineation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/PPaccioretti/paar/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Yield data preprocessing</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/PPaccioretti/paar/blob/HEAD/vignettes/Yield_data.Rmd" class="external-link"><code>vignettes/Yield_data.Rmd</code></a></small>
      <div class="d-none name"><code>Yield_data.Rmd</code></div>
    </div>

    
    
<p>Usually, yield data comes with many noisy observations. This vignette
will show how to preprocess yield data to remove both, spatial and
global outliers. The protocol for error removal follows the protocol
proposed by <span class="citation">Vega et al. (2019)</span>. Functions
from this package are used in FastMapping software <span class="citation">(Paccioretti, Córdoba, and Balzarini 2020)</span>. For
the tutorial we will use the <code>barley</code> dataset that comes with
the <code>paar</code> package. The <code>barley</code> data contains
barley grain yield which were obtained using calibrated commercial yield
monitors, mounted on combines equipped with DGPS. The data is not a
<code>sf</code> object format. We will convert it to an <code>sf</code>
object first.</p>
<p>First, we will load the <code>paar</code> package, the
<code>sf</code> package for spatial data manipulation,
<code>ggplot2</code> for plotting, and the <code>barley</code> dataset
that comes with the <code>paar</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ppaccioretti.github.io/paar/">paar</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"barley"</span>, package <span class="op">=</span> <span class="st">'paar'</span><span class="op">)</span></span></code></pre></div>
<p>The <code>barley</code> dataset is a <code>data.frame</code> object.
We will convert it to a <code>sf</code> object using the
<code>st_as_sf</code> function. The <code>coords</code> argument
specifies the columns that contain the coordinates. The <code>crs</code>
argument specifies the coordinate reference system. The
<code>barley</code> dataset is in UTM zone 20S.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">barley_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">barley</span>, </span>
<span>                      coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span>,</span>
<span>                      crs <span class="op">=</span> <span class="fl">32720</span><span class="op">)</span></span></code></pre></div>
<p>The <code>barley_sf</code> object is now an <code>sf</code> object.
We can plot the data to visualize the yield data.</p>
<ul>
<li>The <code>plot</code> function can be used to plot the data.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">barley_sf</span><span class="op">[</span><span class="st">"Yield"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="Yield_data_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<ul>
<li>The <code>ggplot2</code> package can be used to plot the data.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">barley_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Yield</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Yield_data_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Let’s see the yield values distribution.</p>
<ul>
<li>The <code>hist</code> function can be used to plot the
histogram.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">barley_sf</span><span class="op">$</span><span class="va">Yield</span>, main <span class="op">=</span> <span class="st">'Yield values distribution'</span><span class="op">)</span></span></code></pre></div>
<p><img src="Yield_data_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<ul>
<li>The <code>ggplot2</code> package can be used to plot the
histogram.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">barley_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Yield</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="Yield_data_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>The protocol proposed by <span class="citation">(Vega et al.
2019)</span>, is implemented in the function <code>depurate</code> and
consists of three steps: 1. Remove border observations (<em>edges</em>).
2. Remove global outliers (<em>outliers</em>). 3. Remove spatial
outliers (<em>inliers</em>).</p>
<p>The <code>depurate</code> function takes an <code>sf</code> object as
input and returns an object of class <code>paar</code>. Any combination
of the three steps can be done using the <code>depurate</code> function.
The argument <code>to_remove</code> specifies which steps to perform.
The argument <code>y</code> specifies the column name of the variable to
be cleaned. A field boundary is necessary to remove the <em>edges</em>
observations. If a polygon is not provided in the
<code>poly_border</code> argument, the function will make a hull, around
the data and remove the observation that are 10m from the hull. The hull
is made using <code><a href="https://joelgombin.github.io/concaveman/reference/concaveman.html" class="external-link">concaveman::concaveman</a></code> function if the
package is installed, otherwise, the <code><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">sf::st_convex_hull</a></code>
function is used.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">barley_clean_paar</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/depurate.html">depurate</a></span><span class="op">(</span><span class="va">barley_sf</span>, </span>
<span>           y <span class="op">=</span> <span class="st">'Yield'</span>,</span>
<span>           toremove <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"edges"</span>, <span class="st">"outlier"</span>, <span class="st">"inlier"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Concave hull algorithm is computed with</span></span>
<span><span class="co">#&gt; concavity = 2 and length_threshold = 0</span></span></code></pre></div>
<div class="section level2">
<h2 id="summary-of-the-cleaning-process">Summary of the cleaning process<a class="anchor" aria-label="anchor" href="#summary-of-the-cleaning-process"></a>
</h2>
<p>The <code>depurate</code> function returns an object of class
<code>paar</code>. The <code>paar</code> object contains the cleaned
data (<code>$depurated_data</code>), and the condition of each
observation (<code>$condition</code>). If the condition is
<code>NA</code> means that the observation was not removed.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">barley_clean_paar</span></span>
<span><span class="co">#&gt; Depurated data has 5673 rows.</span></span>
<span><span class="co">#&gt; The process removed 23% of original data.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $depurated_data</span></span>
<span><span class="co">#&gt; Simple feature collection with 5673 features and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 581322.1 ymin: 5953094 xmax: 582393.3 ymax: 5954175</span></span>
<span><span class="co">#&gt; Projected CRS: WGS 84 / UTM zone 20S</span></span>
<span><span class="co">#&gt; First 3 features:</span></span>
<span><span class="co">#&gt;       Yield                 geometry</span></span>
<span><span class="co">#&gt; 3  2.566069 POINT (582393.3 5953877)</span></span>
<span><span class="co">#&gt; 36 3.217464 POINT (582373.4 5953843)</span></span>
<span><span class="co">#&gt; 37 2.651020 POINT (582375.7 5953846)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $condition</span></span>
<span><span class="co">#&gt; vector of length 7394. First 3 elements:</span></span>
<span><span class="co">#&gt; [1] "border" "border" NA</span></span></code></pre></div>
<p>The <code>summary</code> function can be used to get a summary of the
percentage of considered ouliers and the number of observations removed.
The <code>summary</code> function returns a <code>data.frame</code>
object.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">barley_clean_paar</span><span class="op">)</span></span>
<span><span class="va">summary_table</span></span>
<span><span class="co">#&gt;       normal point             border spatial outlier MP spatial outlier LM </span></span>
<span><span class="co">#&gt;         5673 (77%)          964 (13%)         343 (4.6%)         309 (4.2%) </span></span>
<span><span class="co">#&gt;         global min            outlier </span></span>
<span><span class="co">#&gt;          99 (1.3%)         6 (0.081%)</span></span></code></pre></div>
<p>Filtered dataset can be extracted from the <code>paar</code> object
using the <code>$depurated_data</code></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">barley_clean</span> <span class="op">&lt;-</span> <span class="va">barley_clean_paar</span><span class="op">$</span><span class="va">depurated_data</span></span></code></pre></div>
<p>Final Yield values distribution can be plotted.</p>
<ul>
<li>The <code>plot</code> function can be used to plot yield
values.</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">barley_clean</span><span class="op">[</span><span class="st">"Yield"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="Yield_data_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<ul>
<li>The <code>ggplot2</code> package can be used to plot yield
values.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">barley_clean</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Yield</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Yield_data_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>A comparison can be made between the original data and the cleaned
data.</p>
<ul>
<li>Original data</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">barley_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Yield</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Yield_data_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<ul>
<li>Cleaned data</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">barley_clean</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Yield</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Yield_data_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>Also, the distribution of the yield values can be compared.</p>
<ul>
<li>Original data</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">barley_sf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Yield</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="Yield_data_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<ul>
<li>Cleaned data</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">barley_clean</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Yield</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="Yield_data_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="plotting-the-condition-of-each-observation">Plotting the condition of each observation<a class="anchor" aria-label="anchor" href="#plotting-the-condition-of-each-observation"></a>
</h2>
<p>The condition of each observation can be combined to the original
data using the <code>cbind</code> function.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">barley_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">barley_clean_paar</span>, <span class="va">barley_sf</span><span class="op">)</span></span></code></pre></div>
<p>The <code>barley_sf</code> object now contains the condition of each
observation. The <code>condition</code> column contains the condition of
each observation. The condition can be <code>NA</code> if the
observation was not removed, <code>edges</code> if the observation was
removed in the <em>edges</em> step, <code>outlier</code> if the
observation was removed in the <em>outliers</em> step, and
<code>inlier</code> if the observation was removed in the
<em>inliers</em> step. Results can be plotted to visualize the
observations.</p>
<ul>
<li>The <code>plot</code> function can be used to plot the condition of
each observation.</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">barley_sf</span><span class="op">[</span>,<span class="st">'condition'</span><span class="op">]</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">barley_sf</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">barley_sf</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="Yield_data_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<ul>
<li>The <code>ggplot2</code> package can be used to plot the condition
of each observation.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">barley_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_color_discrete</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">{</span><span class="va">k</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"normal"</span>; <span class="va">k</span><span class="op">}</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#44214234"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Yield_data_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Paccioretti2020" class="csl-entry">
Paccioretti, P., M. Córdoba, and M. Balzarini. 2020. <span>“FastMapping:
Software to Create Field Maps and Identify Management Zones in Precision
Agriculture.”</span> <em>Computers and Electronics in Agriculture</em>
175 (August). <a href="https://doi.org/10.1016/j.compag.2020.105556" class="external-link">https://doi.org/10.1016/j.compag.2020.105556</a>.
</div>
<div id="ref-Vega2019" class="csl-entry">
Vega, Andrés, Mariano Córdoba, Mauricio Castro-Franco, and Mónica
Balzarini. 2019. <span>“Protocol for Automating Error Removal from Yield
Maps.”</span> <em>Precision Agriculture</em> 20 (5): 1030–44. <a href="https://doi.org/10.1007/s11119-018-09632-8" class="external-link">https://doi.org/10.1007/s11119-018-09632-8</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pablo Paccioretti, Mariano Córdoba, Franca Giannini Kurina.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
